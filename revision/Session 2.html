<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biology AS Level - Exam Mastery Session</title>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,500;0,9..144,700;1,9..144,400&family=Source+Sans+3:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2235;
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .app-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .header h1 {
            font-family: 'Fraunces', serif;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .progress-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-subtle);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .progress-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .progress-stats {
            display: flex;
            gap: 1.5rem;
            font-size: 0.9rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .stat-dot.completed { background: var(--accent-green); }
        .stat-dot.current { background: var(--accent-amber); }
        .stat-dot.remaining { background: var(--text-muted); }

        .progress-bar {
            height: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .question-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .q-dot {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--bg-primary);
            color: var(--text-muted);
            border: 1px solid var(--border-subtle);
        }

        .q-dot:hover {
            border-color: var(--accent-blue);
            color: var(--text-primary);
        }

        .q-dot.completed {
            background: var(--accent-green);
            color: white;
            border-color: var(--accent-green);
        }

        .q-dot.current {
            background: var(--accent-amber);
            color: var(--bg-primary);
            border-color: var(--accent-amber);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        .question-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-subtle);
            position: relative;
            overflow: hidden;
        }

        .question-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue), var(--accent-purple));
        }

        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-number {
            font-family: 'Fraunces', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-green);
        }

        .question-marks {
            background: var(--bg-secondary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .question-topic {
            display: inline-block;
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent-purple);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
        }

        .question-text strong {
            color: var(--accent-amber);
        }

        .mcq-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .mcq-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mcq-option:hover {
            border-color: var(--accent-blue);
            background: rgba(59, 130, 246, 0.1);
        }

        .mcq-option.selected {
            border-color: var(--accent-amber);
            background: rgba(245, 158, 11, 0.1);
        }

        .mcq-option.correct {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.15);
        }

        .mcq-option.incorrect {
            border-color: var(--accent-rose);
            background: rgba(244, 63, 94, 0.1);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            background: var(--bg-primary);
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .mcq-option.selected .option-letter {
            background: var(--accent-amber);
            color: var(--bg-primary);
        }

        .mcq-option.correct .option-letter {
            background: var(--accent-green);
            color: white;
        }

        .mcq-option.incorrect .option-letter {
            background: var(--accent-rose);
            color: white;
        }

        .answer-section {
            margin: 1.5rem 0;
        }

        .answer-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-secondary);
        }

        .answer-textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.2s ease;
        }

        .answer-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .answer-textarea::placeholder {
            color: var(--text-muted);
        }

        .strategy-panel {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .strategy-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .strategy-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-purple);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .strategy-title {
            font-family: 'Fraunces', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-purple);
        }

        .strategy-content {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .hint-section {
            margin: 1.5rem 0;
        }

        .hint-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--accent-amber);
            border-radius: 10px;
            color: var(--accent-amber);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .hint-btn:hover {
            background: rgba(245, 158, 11, 0.1);
        }

        .hint-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .hint-box {
            margin-top: 1rem;
            padding: 1.25rem;
            background: rgba(245, 158, 11, 0.08);
            border-left: 4px solid var(--accent-amber);
            border-radius: 0 12px 12px 0;
            color: var(--text-secondary);
            display: none;
        }

        .hint-box.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .hint-level {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--accent-amber);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.9rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), #059669);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-subtle);
        }

        .btn-secondary:hover {
            border-color: var(--text-muted);
        }

        .btn-reveal {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
        }

        .btn-reveal:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }

        .markscheme-panel {
            display: none;
            margin-top: 2rem;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--accent-green);
        }

        .markscheme-panel.visible {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .markscheme-header {
            background: linear-gradient(135deg, var(--accent-green), #059669);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .markscheme-header h3 {
            font-family: 'Fraunces', serif;
            font-weight: 600;
            color: white;
        }

        .markscheme-content {
            background: rgba(16, 185, 129, 0.08);
            padding: 1.5rem;
        }

        .mark-point {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: 10px;
            border-left: 3px solid var(--accent-green);
        }

        .mark-point:last-child {
            margin-bottom: 0;
        }

        .mark-bullet {
            width: 24px;
            height: 24px;
            background: var(--accent-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
        }

        .mark-text {
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .examiner-panel {
            display: none;
            margin-top: 1.5rem;
            background: linear-gradient(135deg, rgba(244, 63, 94, 0.08), rgba(245, 158, 11, 0.08));
            border: 1px solid rgba(244, 63, 94, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .examiner-panel.visible {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .examiner-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .examiner-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-rose);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .examiner-title {
            font-family: 'Fraunces', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-rose);
        }

        .examiner-content {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .examiner-tip {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 10px;
            border-left: 3px solid var(--accent-amber);
        }

        .examiner-tip strong {
            color: var(--accent-amber);
        }

        .common-error {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(244, 63, 94, 0.1);
            border-radius: 10px;
            border-left: 3px solid var(--accent-rose);
        }

        .common-error strong {
            color: var(--accent-rose);
        }

        .self-assess {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
        }

        .self-assess-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .score-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .score-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            border: 2px solid var(--border-subtle);
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .score-btn:hover {
            border-color: var(--accent-blue);
            color: var(--text-primary);
        }

        .score-btn.selected {
            border-color: var(--accent-green);
            background: rgba(16, 185, 129, 0.15);
            color: var(--accent-green);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-subtle);
        }

        .scaffold-indicator {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 1rem;
            width: 200px;
            z-index: 100;
        }

        .scaffold-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .scaffold-level {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .scaffold-bar {
            height: 6px;
            background: var(--bg-primary);
            border-radius: 3px;
            overflow: hidden;
        }

        .scaffold-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-amber));
            transition: width 0.5s ease;
        }

        .scaffold-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        .welcome-screen {
            text-align: center;
            padding: 4rem 2rem;
        }

        .welcome-screen h2 {
            font-family: 'Fraunces', serif;
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .welcome-screen p {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 2rem;
            font-size: 1.1rem;
        }

        .welcome-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 800px;
            margin: 2rem auto;
        }

        .feature-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-subtle);
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
        }

        .feature-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .feature-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .sub-question {
            margin: 1.5rem 0;
            padding: 1.25rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border-left: 3px solid var(--accent-blue);
        }

        .sub-question-label {
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 0.75rem;
        }

        /* Data tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .data-table th, .data-table td {
            padding: 0.75rem;
            border: 1px solid var(--border-subtle);
            text-align: left;
        }

        .data-table th {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-weight: 600;
        }

        .data-table td {
            color: var(--text-secondary);
        }

        .data-table tr:hover td {
            background: rgba(59, 130, 246, 0.05);
        }

        /* Diagram containers */
        .diagram-container {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }

        .diagram-container svg {
            max-width: 100%;
            height: auto;
        }

        .diagram-caption {
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Drawing area */
        .drawing-area {
            background: white;
            border-radius: 8px;
            min-height: 200px;
            margin: 1rem 0;
            position: relative;
        }

        .drawing-instructions {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #999;
            font-size: 0.9rem;
            text-align: center;
        }

        .completion-screen {
            text-align: center;
            padding: 4rem 2rem;
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
        }

        .completion-screen h2 {
            font-family: 'Fraunces', serif;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .final-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .final-stat {
            text-align: center;
        }

        .final-stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-green);
        }

        .final-stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .scaffold-indicator {
                position: static;
                width: 100%;
                margin-bottom: 1.5rem;
            }

            .question-card {
                padding: 1.5rem;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Molecule diagrams */
        .molecule-symbol {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            font-family: monospace;
            background: var(--bg-primary);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .subscript {
            font-size: 0.7em;
            vertical-align: sub;
        }

        /* Graph container */
        .graph-container {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .graph-container svg {
            width: 100%;
            max-width: 500px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>Biology AS Level - Exam Mastery</h1>
            <p class="subtitle">Biological Molecules ‚Ä¢ Adaptive Scaffolding ‚Ä¢ Examiner Insights</p>
        </header>

        <div id="scaffoldIndicator" class="scaffold-indicator" style="display: none;">
            <div class="scaffold-title">Support Level</div>
            <div class="scaffold-level" id="scaffoldLevel">High Support</div>
            <div class="scaffold-bar">
                <div class="scaffold-fill" id="scaffoldFill" style="width: 100%;"></div>
            </div>
            <div class="scaffold-desc" id="scaffoldDesc">Full hints and guidance available</div>
        </div>

        <section class="progress-section" id="progressSection" style="display: none;">
            <div class="progress-header">
                <span class="progress-title">Session Progress</span>
                <div class="progress-stats">
                    <span class="stat"><span class="stat-dot completed"></span> <span id="completedCount">0</span> Completed</span>
                    <span class="stat"><span class="stat-dot current"></span> <span id="currentQ">1</span> Current</span>
                    <span class="stat"><span class="stat-dot remaining"></span> <span id="remainingCount">12</span> Remaining</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
            <div class="question-nav" id="questionNav"></div>
        </section>

        <main id="mainContent">
            <div class="welcome-screen" id="welcomeScreen">
                <h2>Ready to Master Your Exam Technique?</h2>
                <p>This interactive session takes you through 12 carefully selected exam questions with progressive challenge. You'll receive full support early on, with hints gradually reducing as you build confidence.</p>
                
                <div class="welcome-features">
                    <div class="feature-card">
                        <div class="feature-icon">üéØ</div>
                        <div class="feature-title">Exam Strategy</div>
                        <div class="feature-desc">Learn command words, timing, and approach for each question type</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìù</div>
                        <div class="feature-title">Mark Schemes</div>
                        <div class="feature-desc">See exactly what examiners look for in top-scoring answers</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üí°</div>
                        <div class="feature-title">Examiner Insights</div>
                        <div class="feature-desc">Common mistakes and tips straight from examiner reports</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìà</div>
                        <div class="feature-title">Adaptive Support</div>
                        <div class="feature-desc">Scaffolding reduces as you progress through questions</div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="startSession()">
                    Start Revision Session ‚Üí
                </button>
            </div>

            <div id="questionContainer" style="display: none;"></div>

            <div class="completion-screen" id="completionScreen" style="display: none;">
                <div class="completion-icon">üèÜ</div>
                <h2>Session Complete!</h2>
                <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">Excellent work! You've worked through all questions and built stronger exam technique.</p>
                
                <div class="final-stats">
                    <div class="final-stat">
                        <div class="final-stat-value" id="finalCompleted">12</div>
                        <div class="final-stat-label">Questions Reviewed</div>
                    </div>
                    <div class="final-stat">
                        <div class="final-stat-value" id="finalMarks">85</div>
                        <div class="final-stat-label">Total Marks Available</div>
                    </div>
                </div>
                
                <div style="margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="restartSession()">Start Again</button>
                    <button class="btn btn-secondary" onclick="reviewAll()" style="margin-left: 1rem;">Review All Questions</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Question Data - Only including questions that work without complex diagrams
        const questions = [
            {
                id: 1,
                topic: "Enzymes & Amino Acids",
                totalMarks: 5,
                parts: [
                    {
                        label: "(a)",
                        type: "mcq",
                        marks: 1,
                        question: "Enzyme molecules are formed from chains of amino acids joined together. Which pair of elements is found in <strong>all</strong> amino acids?",
                        options: [
                            { letter: "A", text: "carbon and oxygen" },
                            { letter: "B", text: "carbon and sulfur" },
                            { letter: "C", text: "nitrogen and magnesium" },
                            { letter: "D", text: "oxygen and magnesium" }
                        ],
                        correct: "A",
                        explanation: "All amino acids contain carbon, hydrogen, oxygen, and nitrogen (CHON). Sulfur is only found in some amino acids (cysteine, methionine), and magnesium is not part of amino acid structure."
                    },
                    {
                        label: "(b)",
                        type: "mcq",
                        marks: 1,
                        question: "Which row describes how two amino acids are joined together in an enzyme molecule?",
                        tableHtml: `
                            <table class="data-table">
                                <thead>
                                    <tr><th></th><th>Type of reaction</th><th>Type of bond formed</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>A</strong></td><td>Condensation</td><td>Glycosidic</td></tr>
                                    <tr><td><strong>B</strong></td><td>Condensation</td><td>Peptide</td></tr>
                                    <tr><td><strong>C</strong></td><td>Hydrolysis</td><td>Glycosidic</td></tr>
                                    <tr><td><strong>D</strong></td><td>Hydrolysis</td><td>Peptide</td></tr>
                                </tbody>
                            </table>
                        `,
                        options: [
                            { letter: "A", text: "Condensation reaction forming a glycosidic bond" },
                            { letter: "B", text: "Condensation reaction forming a peptide bond" },
                            { letter: "C", text: "Hydrolysis reaction forming a glycosidic bond" },
                            { letter: "D", text: "Hydrolysis reaction forming a peptide bond" }
                        ],
                        correct: "B",
                        explanation: "Amino acids join via condensation reactions (releasing water) to form peptide bonds. Glycosidic bonds join sugars, not amino acids. Hydrolysis breaks bonds, it doesn't form them."
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 3,
                        question: "Describe how a chain of amino acids can form an enzyme molecule.",
                        hints: [
                            "Think about the levels of protein structure - what happens to the chain after it's made?",
                            "Consider: secondary structure (what bonds? what shapes?), tertiary structure (what bonds between R groups?)",
                            "Don't forget to mention the active site - this question is about enzymes specifically!"
                        ],
                        markScheme: [
                            "Chain folds/coils to form secondary structure (alpha helix/beta pleated sheet)",
                            "Hydrogen bonds form between amino acids in the chain",
                            "Further folding produces tertiary structure",
                            "Bonds form between R groups (ionic, disulfide, hydrogen bonds)",
                            "Creates specific shape including active site"
                        ],
                        examinerInsight: "Most candidates gained marks for secondary and tertiary structure. However, very few mentioned the active site despite the topic being enzymes. Many started with primary structure which wasn't wrong but used valuable exam time.",
                        examinerTip: "When naming bonds in secondary/tertiary structure, state that bonds form between R groups specifically."
                    }
                ],
                strategy: {
                    title: "MCQ Strategy + Short Answer",
                    content: "For MCQs: eliminate obviously wrong answers first. For part (c), the command word is 'Describe' - you need to give a step-by-step account of the process. 3 marks typically means 3 distinct points needed."
                }
            },
            {
                id: 2,
                topic: "Diabetes & Carbohydrates",
                totalMarks: 6,
                parts: [
                    {
                        label: "(a)",
                        type: "mcq",
                        marks: 1,
                        question: "A person with diabetes has blood glucose that can be too high. When blood glucose becomes too high in a healthy person, the liver stores glucose as a polysaccharide. Which polysaccharide does the liver store?",
                        options: [
                            { letter: "A", text: "amylopectin" },
                            { letter: "B", text: "cellulose" },
                            { letter: "C", text: "glycogen" },
                            { letter: "D", text: "starch" }
                        ],
                        correct: "C",
                        explanation: "Glycogen is the storage polysaccharide in animals (liver and muscles). Starch and amylopectin are plant storage molecules. Cellulose is structural in plant cell walls."
                    },
                    {
                        label: "(b)",
                        type: "mcq",
                        marks: 1,
                        question: "Blood glucose levels can become high following the digestion of carbohydrates. Which of the following can be digested to release glucose?",
                        options: [
                            { letter: "A", text: "both fructose and sucrose" },
                            { letter: "B", text: "both fructose and galactose" },
                            { letter: "C", text: "both galactose and lactose" },
                            { letter: "D", text: "both lactose and sucrose" }
                        ],
                        correct: "D",
                        explanation: "Sucrose = glucose + fructose. Lactose = glucose + galactose. Both release glucose when digested. Fructose and galactose are monosaccharides - they cannot be further digested to release glucose."
                    },
                    {
                        label: "(c)(i)",
                        type: "calculation",
                        marks: 1,
                        question: "One estimate is that there are <strong>415 million</strong> people with diabetes in the world and that <strong>46%</strong> of these people are undiagnosed. Calculate the number of people who have undiagnosed diabetes.",
                        answer: "190.9 million (or 191 million)",
                        working: "415 √ó 0.46 = 190.9 million"
                    },
                    {
                        label: "(c)(ii)",
                        type: "written",
                        marks: 3,
                        question: "There are two types of diabetes, Type I and Type II. The treatment differs, so correct diagnosis is important. Genetic screening is now available for diagnosis. Explain why doctors are more likely to screen individuals <strong>once they develop diabetes</strong> than use methods such as prenatal testing.",
                        hints: [
                            "Think about when/why testing would be useful - what's the purpose of the test?",
                            "Consider: treatments available, lifestyle changes, the nature of Type II diabetes"
                        ],
                        markScheme: [
                            "Treatment can begin/lifestyle changes can be made when diagnosed",
                            "Type II diabetes can be treated with diet/exercise modification",
                            "Type II develops later in life/linked to lifestyle factors",
                            "Prenatal testing cannot predict lifestyle-related conditions"
                        ],
                        examinerInsight: "Candidates needed to think about the practical reasons for testing at different life stages and the different nature of Type I vs Type II diabetes."
                    }
                ],
                strategy: {
                    title: "Understanding Question Context",
                    content: "This question tests your knowledge across carbohydrates AND diabetes - a synoptic link. For the calculation, show your working. For part (c)(ii), 'Explain' means give reasons - use 'because', 'therefore', 'as a result'."
                }
            },
            {
                id: 3,
                topic: "Cell Membrane Fluidity",
                totalMarks: 8,
                parts: [
                    {
                        label: "(a)",
                        type: "written",
                        marks: 2,
                        question: `Membrane fluidity is increased by several factors:
                        <ul style="margin: 1rem 0; margin-left: 1.5rem;">
                            <li>increase in temperature</li>
                            <li>increase in the proportion of unsaturated fatty acids</li>
                            <li>decrease in cholesterol</li>
                            <li>fatty acids with shorter side chains</li>
                        </ul>
                        Explain why an <strong>increase in temperature</strong> increases the fluidity of the membrane.`,
                        hints: [
                            "What does temperature do to molecules?",
                            "Think about kinetic energy and movement"
                        ],
                        markScheme: [
                            "Increased temperature gives phospholipids more kinetic energy",
                            "Phospholipids move more/faster within the bilayer"
                        ],
                        examinerInsight: "Candidates were good at linking temperature to kinetic energy. Avoid saying 'the bilayer moves' - the phospholipids move WITHIN the bilayer."
                    },
                    {
                        label: "(b)",
                        type: "mcq",
                        marks: 1,
                        question: "Which row describes an <strong>unsaturated</strong> fatty acid compared with a saturated fatty acid with the same number of carbon atoms?",
                        tableHtml: `
                            <table class="data-table">
                                <thead>
                                    <tr><th></th><th>Number of hydrogen atoms</th><th>C=C double bonds</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>A</strong></td><td>Fewer</td><td>Contains C=C</td></tr>
                                    <tr><td><strong>B</strong></td><td>Fewer</td><td>No C=C</td></tr>
                                    <tr><td><strong>C</strong></td><td>More</td><td>Contains C=C</td></tr>
                                    <tr><td><strong>D</strong></td><td>More</td><td>No C=C</td></tr>
                                </tbody>
                            </table>
                        `,
                        options: [
                            { letter: "A", text: "Fewer hydrogen atoms, contains C=C double bond" },
                            { letter: "B", text: "Fewer hydrogen atoms, no C=C double bond" },
                            { letter: "C", text: "More hydrogen atoms, contains C=C double bond" },
                            { letter: "D", text: "More hydrogen atoms, no C=C double bond" }
                        ],
                        correct: "A",
                        explanation: "Unsaturated = contains C=C double bonds, which means fewer hydrogen atoms are bonded (not 'saturated' with hydrogen). The double bond means two fewer hydrogens per C=C."
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 2,
                        question: "Explain why a <strong>decrease in cholesterol</strong> increases the fluidity of the membrane.",
                        hints: [
                            "What does cholesterol do in the membrane normally?",
                            "Think about how cholesterol interacts with phospholipids"
                        ],
                        markScheme: [
                            "Cholesterol binds to/interacts with phospholipid tails",
                            "Cholesterol restricts/reduces movement of phospholipids",
                            "Less cholesterol = less restriction = more fluidity"
                        ],
                        examinerInsight: "This was challenging - candidates were less confident about cholesterol's role. It acts as a 'buffer' - reducing fluidity at high temps and maintaining it at low temps."
                    },
                    {
                        label: "(d)",
                        type: "written",
                        marks: 1,
                        question: "Suggest why a fatty acid with a <strong>shorter side chain</strong> will increase the fluidity of a membrane.",
                        hints: [
                            "Think about interactions between fatty acid tails"
                        ],
                        markScheme: [
                            "Fewer/weaker hydrophobic interactions between tails",
                            "OR less surface area for interactions between adjacent phospholipids"
                        ],
                        examinerInsight: "The command word 'suggest' means you can infer from context - you don't need to have been taught this specifically."
                    },
                    {
                        label: "(e)",
                        type: "written",
                        marks: 2,
                        question: "When fish are moved to colder water, the fatty acid content of their membranes changes. Suggest how the content of fatty acids in these membranes may have changed.",
                        hints: [
                            "Look back at what increases fluidity - fish need to maintain membrane fluidity in cold water"
                        ],
                        markScheme: [
                            "More unsaturated fatty acids",
                            "Shorter chain fatty acids",
                            "Either change maintains fluidity at lower temperatures"
                        ],
                        examinerInsight: "Well answered - candidates linked the bullet points about fluidity to this application question. Use the information given earlier in the question!"
                    }
                ],
                strategy: {
                    title: "Using Question Stems",
                    content: "This question helpfully lists factors affecting fluidity at the start. Use this information when answering later parts - the examiners gave you a hint! 'Suggest' questions require logical inference from what you know."
                }
            },
            {
                id: 4,
                topic: "Biological Molecules - Table Completion",
                totalMarks: 7,
                parts: [
                    {
                        label: "(a)",
                        type: "table-completion",
                        marks: 4,
                        question: "Polymers are large molecules made of monomers. Complete the table by filling in the empty boxes with either the name of the monomer, the elements present in each monomer, or the type of bond between monomers.",
                        tableHtml: `
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Polymer</th>
                                        <th>Monomer</th>
                                        <th>Elements in monomer</th>
                                        <th>Bond between monomers</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Polysaccharide</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                        <td>C, H, O</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                    </tr>
                                    <tr>
                                        <td>Protein</td>
                                        <td>Amino acid</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                    </tr>
                                    <tr>
                                        <td>Nucleic acid (DNA/RNA)</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                        <td style="background: rgba(245, 158, 11, 0.2);">?</td>
                                        <td>Phosphodiester</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-muted);">Yellow highlighted cells need completing.</p>
                        `,
                        hints: [
                            "Polysaccharides are made of sugar monomers - what's the general name?",
                            "Remember CHON for amino acids, but some also contain S",
                            "What are the monomers of DNA/RNA? What elements do they contain?"
                        ],
                        markScheme: [
                            "Polysaccharide monomer: monosaccharide (or glucose)",
                            "Polysaccharide bond: glycosidic",
                            "Protein elements: C, H, O, N (accept also S)",
                            "Protein bond: peptide",
                            "Nucleic acid monomer: nucleotide",
                            "Nucleic acid elements: C, H, O, N, P"
                        ]
                    },
                    {
                        label: "(b)",
                        type: "written",
                        marks: 3,
                        question: "Triglycerides are lipids. Describe how an <strong>unsaturated</strong> triglyceride is synthesised.",
                        hints: [
                            "What are the components of a triglyceride?",
                            "What reaction joins them? What type of bond forms?",
                            "What makes it 'unsaturated'?"
                        ],
                        markScheme: [
                            "Glycerol + 3 fatty acids (at least one unsaturated)",
                            "Condensation reaction (water released)",
                            "Ester bonds form between glycerol and fatty acids",
                            "Unsaturated fatty acids contain C=C double bonds"
                        ],
                        examinerInsight: "Many candidates forgot to mention the unsaturated aspect - read questions carefully for key words that are emphasised (bold/italicised)."
                    }
                ],
                strategy: {
                    title: "Table Completion & Definitions",
                    content: "Table questions test precise recall. Learn your monomers, bonds, and elements for each biological molecule type. For 'describe synthesis' questions, always include: reactants, reaction type, and bond formed."
                }
            },
            {
                id: 5,
                topic: "Haemoglobin Structure",
                totalMarks: 9,
                parts: [
                    {
                        label: "(a)",
                        type: "written",
                        marks: 3,
                        question: "Describe the structure of a haemoglobin molecule.",
                        hints: [
                            "How many polypeptide chains? What are they called?",
                            "What non-protein group is present? What element does it contain?"
                        ],
                        markScheme: [
                            "4 polypeptide chains (2 alpha, 2 beta) / quaternary structure",
                            "Contains haem groups (prosthetic group)",
                            "Each haem contains an iron ion (Fe¬≤‚Å∫)",
                            "Globular protein shape"
                        ],
                        examinerInsight: "The least frequently awarded mark was for iron being an ION. When naming elements in proteins, state if it's in ion form.",
                        examinerTip: "When naming a particular element in your answer, you must state that it is in the form of an ion if appropriate."
                    },
                    {
                        label: "(b)(i)",
                        type: "mcq",
                        marks: 1,
                        question: "A dissociation curve shows percentage saturation of haemoglobin plotted against partial pressure of oxygen. The curve has an S-shape. Which describes this dissociation curve?",
                        options: [
                            { letter: "A", text: "linear curve showing a positive correlation" },
                            { letter: "B", text: "linear curve showing a negative correlation" },
                            { letter: "C", text: "sigmoid curve showing a negative correlation" },
                            { letter: "D", text: "sigmoid curve showing a positive correlation" }
                        ],
                        correct: "D",
                        explanation: "The oxygen dissociation curve is S-shaped (sigmoid) and shows positive correlation - as partial pressure of oxygen increases, percentage saturation increases."
                    },
                    {
                        label: "(b)(ii)",
                        type: "mcq",
                        marks: 1,
                        question: "Which name is given to the effect of increasing carbon dioxide concentration on the dissociation curve?",
                        options: [
                            { letter: "A", text: "Benedict" },
                            { letter: "B", text: "Bohr" },
                            { letter: "C", text: "Fick" },
                            { letter: "D", text: "Stahl" }
                        ],
                        correct: "B",
                        explanation: "The Bohr effect (or Bohr shift) describes how increased CO‚ÇÇ shifts the curve to the right, reducing haemoglobin's affinity for oxygen and helping oxygen release in respiring tissues."
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 3,
                        question: "Explain how the structure of haemoglobin is related to its function in transporting oxygen <strong>and</strong> carbon dioxide.",
                        hints: [
                            "Think structure ‚Üí function: what structural features enable oxygen binding?",
                            "Where does CO‚ÇÇ bind? (It's NOT on the haem group!)"
                        ],
                        markScheme: [
                            "4 haem groups each bind one O‚ÇÇ / can carry 4 oxygen molecules",
                            "Iron ion in haem binds reversibly to oxygen",
                            "Quaternary structure allows cooperative binding (binding becomes easier after first O‚ÇÇ)",
                            "CO‚ÇÇ binds to the polypeptide chains / amino acid R groups (not haem)"
                        ],
                        examinerInsight: "We saw good descriptions of haemoglobin structure, but the question asked to EXPLAIN how structure relates to FUNCTION - you must link them! Many think CO‚ÇÇ binds to haem - it actually binds to amino acids in the polypeptide chains (forming carbaminohaemoglobin).",
                        examinerTip: "Don't confuse carboxyhaemoglobin (CO binding - poisonous) with carbaminohaemoglobin (CO‚ÇÇ binding - normal transport)."
                    }
                ],
                strategy: {
                    title: "Structure-Function Questions",
                    content: "When asked to 'explain how structure relates to function', you must LINK specific structural features to specific functions. Don't just describe structure separately from function."
                }
            },
            {
                id: 6,
                topic: "Water Properties",
                totalMarks: 5,
                parts: [
                    {
                        label: "(a)",
                        type: "diagram",
                        marks: 2,
                        question: "Draw a diagram of a water molecule to show its <strong>dipole nature</strong>.",
                        diagramHtml: `
                            <div class="diagram-container">
                                <p style="color: var(--text-secondary); margin-bottom: 1rem;">Draw your diagram showing:</p>
                                <ul style="text-align: left; margin-left: 2rem; color: var(--text-muted);">
                                    <li>The oxygen atom and two hydrogen atoms</li>
                                    <li>The bent/angular shape</li>
                                    <li>Partial charges (Œ¥+ and Œ¥-) in the correct positions</li>
                                </ul>
                                <div class="drawing-area">
                                    <div class="drawing-instructions">Draw your answer on paper</div>
                                </div>
                            </div>
                        `,
                        hints: [
                            "Show the molecule structure AND the charge distribution",
                            "Remember: slightly positive and slightly negative (use Œ¥+ and Œ¥-)",
                            "Oxygen is more electronegative than hydrogen"
                        ],
                        markScheme: [
                            "Correct structure: O with two H atoms at an angle (not linear)",
                            "Partial charges shown: Œ¥+ on both H atoms, Œ¥- on O atom"
                        ],
                        examinerInsight: "Many drew good diagrams but lost marks for not showing the PARTIAL charges (using Œ¥+ and Œ¥-). Also some reversed the positive and negative - remember oxygen is more electronegative so pulls electrons towards it.",
                        examinerTip: "Drawing diagrams may seem easy but care is needed to ensure accuracy."
                    },
                    {
                        label: "(b)",
                        type: "written",
                        marks: 3,
                        question: `The graph below shows the effect of temperature on the solubility in water of three salts, F, G and H, found in the human diet.
                        <div class="graph-container">
                            <svg viewBox="0 0 400 300" style="background: white; border-radius: 8px;">
                                <!-- Axes -->
                                <line x1="60" y1="250" x2="380" y2="250" stroke="#333" stroke-width="2"/>
                                <line x1="60" y1="250" x2="60" y2="30" stroke="#333" stroke-width="2"/>
                                
                                <!-- X-axis labels -->
                                <text x="220" y="285" text-anchor="middle" fill="#333" font-size="12">Temperature (¬∞C)</text>
                                <text x="60" y="265" text-anchor="middle" fill="#666" font-size="10">0</text>
                                <text x="140" y="265" text-anchor="middle" fill="#666" font-size="10">20</text>
                                <text x="220" y="265" text-anchor="middle" fill="#666" font-size="10">40</text>
                                <text x="300" y="265" text-anchor="middle" fill="#666" font-size="10">60</text>
                                <text x="380" y="265" text-anchor="middle" fill="#666" font-size="10">80</text>
                                
                                <!-- Y-axis labels -->
                                <text x="30" y="150" text-anchor="middle" fill="#333" font-size="12" transform="rotate(-90, 30, 150)">Solubility (g per 100g water)</text>
                                <text x="50" y="250" text-anchor="end" fill="#666" font-size="10">0</text>
                                <text x="50" y="195" text-anchor="end" fill="#666" font-size="10">25</text>
                                <text x="50" y="140" text-anchor="end" fill="#666" font-size="10">50</text>
                                <text x="50" y="85" text-anchor="end" fill="#666" font-size="10">75</text>
                                <text x="50" y="35" text-anchor="end" fill="#666" font-size="10">100</text>
                                
                                <!-- Grid lines -->
                                <line x1="60" y1="195" x2="380" y2="195" stroke="#ddd" stroke-width="1"/>
                                <line x1="60" y1="140" x2="380" y2="140" stroke="#ddd" stroke-width="1"/>
                                <line x1="60" y1="85" x2="380" y2="85" stroke="#ddd" stroke-width="1"/>
                                
                                <!-- Salt F - steep increase -->
                                <path d="M60,230 Q180,180 300,80 T380,40" fill="none" stroke="#e74c3c" stroke-width="3"/>
                                <text x="385" y="45" fill="#e74c3c" font-size="12" font-weight="bold">F</text>
                                
                                <!-- Salt G - moderate increase -->
                                <path d="M60,210 L140,185 L220,160 L300,130 L380,95" fill="none" stroke="#3498db" stroke-width="3"/>
                                <text x="385" y="100" fill="#3498db" font-size="12" font-weight="bold">G</text>
                                
                                <!-- Salt H - nearly flat -->
                                <path d="M60,205 L140,203 L220,200 L300,197 L380,193" fill="none" stroke="#27ae60" stroke-width="3"/>
                                <text x="385" y="198" fill="#27ae60" font-size="12" font-weight="bold">H</text>
                            </svg>
                        </div>
                        <p style="margin-top: 1rem;">Describe the effect of temperature on the solubility of these three salts.</p>`,
                        hints: [
                            "Three salts + three marks = describe each salt separately",
                            "Include specific values or clear references to the graph"
                        ],
                        markScheme: [
                            "Salt F: solubility increases steeply/rapidly with temperature (from ~20 to ~95 g per 100g)",
                            "Salt G: solubility increases steadily/moderately with temperature (from ~20 to ~50 g per 100g)",
                            "Salt H: solubility remains relatively constant/changes very little with temperature (~20-22 g per 100g)"
                        ],
                        examinerInsight: "Better responses wrote one sentence about each salt. Weaker responses only mentioned one or two salts or tried to describe temperature ranges without referring to each salt.",
                        examinerTip: "If there are 3 lines on a graph and 3 marks, each line needs a separate description."
                    }
                ],
                strategy: {
                    title: "Diagram Drawing & Graph Description",
                    content: "When describing graphs, match your response structure to the marks available. If 3 marks for 3 lines, write about each line separately. Use comparative language (steeper, more gradual, constant)."
                }
            },
            {
                id: 7,
                topic: "DNA & Protein Synthesis",
                totalMarks: 5,
                parts: [
                    {
                        label: "(a)",
                        type: "written",
                        marks: 2,
                        question: "When a cell is preparing to divide, DNA synthesis takes place. Explain how <strong>two identical molecules</strong> of DNA are produced.",
                        hints: [
                            "What happens to the original DNA molecule first?",
                            "What acts as a template? How is accuracy ensured?"
                        ],
                        markScheme: [
                            "Both/each strand acts as a template",
                            "Complementary base pairing ensures identical copies (A-T, G-C)",
                            "Semi-conservative replication (each new molecule has one original strand and one new strand)"
                        ],
                        examinerInsight: "A common error was stating that complementary BASES line up against the parent strand - it's complementary NUCLEOTIDES that line up (nucleotides include the base, sugar, and phosphate).",
                        examinerTip: "Nucleotides line up by complementary base pairing - the whole nucleotide is added, not just the base."
                    },
                    {
                        label: "(b)",
                        type: "written",
                        marks: 3,
                        question: "Protein synthesis increases as a cell grows. Describe the roles of messenger RNA (mRNA) and transfer RNA (tRNA) in protein synthesis.",
                        hints: [
                            "What does mRNA carry? From where to where?",
                            "What does tRNA carry? What feature does it have that allows it to 'read' the code?"
                        ],
                        markScheme: [
                            "mRNA carries genetic code/sequence from nucleus to ribosome",
                            "mRNA codons are read at the ribosome",
                            "tRNA carries specific amino acids to the ribosome",
                            "tRNA has anticodon that base-pairs with mRNA codon",
                            "Amino acids are joined in the sequence determined by mRNA"
                        ],
                        examinerInsight: "Centres are using mark schemes to prepare candidates - we're seeing more accurate responses. Avoid using arrows instead of words (e.g., write 'involved in' not ‚Üí).",
                        examinerTip: "It's safer to write words rather than symbols. Write 'involved in' instead of using arrows."
                    }
                ],
                strategy: {
                    title: "Molecular Biology Processes",
                    content: "For process descriptions, think about the sequence of events and the key molecules involved. Be specific about what each molecule does and where it works (nucleus vs cytoplasm/ribosome)."
                }
            },
            {
                id: 8,
                topic: "Protein Structure - Keratin",
                totalMarks: 7,
                parts: [
                    {
                        label: "(a)",
                        type: "written",
                        marks: 2,
                        question: "Hair is made from an insoluble fibrous protein called keratin. Describe <strong>two</strong> structural features of insoluble fibrous proteins.",
                        hints: [
                            "Think about collagen - another fibrous protein you've studied",
                            "What makes fibrous proteins different from globular proteins?"
                        ],
                        markScheme: [
                            "Long polypeptide chains",
                            "Chains wound/coiled together (e.g., triple helix in collagen)",
                            "Hydrogen bonds between chains",
                            "Repeating sequences of amino acids",
                            "No tertiary structure/limited 3D folding"
                        ],
                        examinerInsight: "Use your knowledge of collagen to answer questions about fibrous proteins. Keratin may be unfamiliar but the principles are the same.",
                        examinerTip: "If a context seems unfamiliar, identify the topic area and use what you've been taught. Keratin ‚Üí fibrous protein ‚Üí use your collagen knowledge."
                    },
                    {
                        label: "(b)",
                        type: "diagram",
                        marks: 3,
                        question: `Keratin contains a high proportion of the amino acid cysteine. Disulfide bridges form between the R groups of two cysteines.
                        <div class="diagram-container">
                            <p>The R group of cysteine is shown below:</p>
                            <svg viewBox="0 0 200 80" style="max-width: 200px;">
                                <text x="20" y="45" fill="#333" font-family="monospace" font-size="16">‚ÄîCH‚ÇÇ‚ÄîSH</text>
                            </svg>
                            <p style="margin-top: 1rem; color: var(--text-secondary);">Draw the <strong>complete structure</strong> of the amino acid cysteine.</p>
                        </div>`,
                        hints: [
                            "You know the general amino acid structure: amino group, carboxyl group, central carbon, R group",
                            "Just add the given R group (-CH‚ÇÇ-SH) to the correct position on the central carbon"
                        ],
                        markScheme: [
                            "Correct amino group (NH‚ÇÇ or H‚ÇÇN-)",
                            "Correct carboxyl group (COOH or -CO‚ÇÇH)",
                            "Central carbon with H attached (4 bonds total to central C)",
                            "R group (-CH‚ÇÇ-SH) correctly attached to central carbon"
                        ],
                        examinerInsight: "Most common error: missing the H on the central carbon. Carbon needs 4 bonds, nitrogen needs 3, oxygen needs 2, hydrogen needs 1 - count them!",
                        examinerTip: "Carbon needs 4 bonds, oxygen needs 2, nitrogen needs 3, hydrogen needs 1. A quick count may save a mark."
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 2,
                        question: "Describe the secondary structure of a polypeptide.",
                        markScheme: [
                            "Alpha helix and/or beta pleated sheet shapes",
                            "Held together by hydrogen bonds",
                            "Hydrogen bonds form between C=O and N-H groups in the backbone (NOT between R groups)"
                        ],
                        examinerInsight: "The hydrogen bonds in secondary structure do NOT form between R groups - this is a common misconception. They form between backbone atoms (the peptide bond region).",
                        examinerTip: "Secondary structure H-bonds are between backbone C=O and N-H groups, NOT between R groups. R group interactions create tertiary structure."
                    }
                ],
                strategy: {
                    title: "Amino Acid & Protein Structure",
                    content: "Know your general amino acid structure - you can then apply it to any amino acid when given the R group. Remember the difference between secondary structure bonds (backbone) and tertiary structure bonds (R groups)."
                }
            },
            {
                id: 9,
                topic: "Sugars - Monosaccharides & Disaccharides",
                totalMarks: 6,
                parts: [
                    {
                        label: "(a)(i)",
                        type: "mcq",
                        marks: 1,
                        question: "Which row of the table shows which of these sugars are monosaccharides and which are disaccharides?",
                        tableHtml: `
                            <table class="data-table">
                                <thead>
                                    <tr><th></th><th>Monosaccharides</th><th>Disaccharides</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>A</strong></td><td>glucose, fructose, galactose</td><td>maltose, sucrose, lactose</td></tr>
                                    <tr><td><strong>B</strong></td><td>glucose, maltose</td><td>fructose, galactose, sucrose, lactose</td></tr>
                                    <tr><td><strong>C</strong></td><td>glucose, fructose, sucrose</td><td>galactose, maltose, lactose</td></tr>
                                    <tr><td><strong>D</strong></td><td>maltose, sucrose, lactose</td><td>glucose, fructose, galactose</td></tr>
                                </tbody>
                            </table>
                        `,
                        options: [
                            { letter: "A", text: "Mono: glucose, fructose, galactose | Di: maltose, sucrose, lactose" },
                            { letter: "B", text: "Mono: glucose, maltose | Di: fructose, galactose, sucrose, lactose" },
                            { letter: "C", text: "Mono: glucose, fructose, sucrose | Di: galactose, maltose, lactose" },
                            { letter: "D", text: "Mono: maltose, sucrose, lactose | Di: glucose, fructose, galactose" }
                        ],
                        correct: "A",
                        explanation: "Monosaccharides (single sugars): glucose, fructose, galactose. Disaccharides (two joined): maltose (glu+glu), sucrose (glu+fru), lactose (glu+gal). Learn these combinations!"
                    },
                    {
                        label: "(a)(ii)",
                        type: "mcq",
                        marks: 1,
                        question: "Which type of bond joins two monosaccharides together to form a disaccharide?",
                        options: [
                            { letter: "A", text: "ester" },
                            { letter: "B", text: "glycosidic" },
                            { letter: "C", text: "peptide" },
                            { letter: "D", text: "phosphodiester" }
                        ],
                        correct: "B",
                        explanation: "Glycosidic bonds join sugars. Peptide bonds join amino acids. Ester bonds are in lipids (glycerol + fatty acids). Phosphodiester bonds are in nucleic acids (between nucleotides)."
                    },
                    {
                        label: "(b)",
                        type: "written",
                        marks: 2,
                        question: `Sucrose is made from glucose and fructose. Complete the formula equation for the reaction that makes sucrose:
                        <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; margin: 1rem 0; font-family: monospace; font-size: 1.1rem; text-align: center;">
                            C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ ‚Üí _________ + _________
                        </div>`,
                        hints: [
                            "This is a condensation reaction - what small molecule is released?",
                            "If you remove H‚ÇÇO from two C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ, what's left?"
                        ],
                        markScheme: [
                            "Sucrose formula: C‚ÇÅ‚ÇÇH‚ÇÇ‚ÇÇO‚ÇÅ‚ÇÅ",
                            "Water released: H‚ÇÇO"
                        ],
                        examinerInsight: "The commonest error was omitting the H‚ÇÇO, even when the sucrose formula was correct. Remember: condensation = water released!"
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 2,
                        question: `A test for sucrose concentration involves:
                        <ol style="margin: 1rem 0 1rem 1.5rem;">
                            <li>Hydrolysing sucrose to glucose and fructose</li>
                            <li>Fructose reacts with a reagent to produce a colour</li>
                            <li>Colour intensity is measured</li>
                        </ol>
                        The colour intensity is directly proportional to the concentration of sucrose.
                        <br><br>
                        <strong>(i)</strong> Give a reason why the colour intensity is directly proportional to the concentration of sucrose. [1 mark]
                        <br><br>
                        <strong>(ii)</strong> State why the concentration of maltose and lactose cannot be measured using this test. [1 mark]`,
                        hints: [
                            "What does sucrose contain that produces the colour?",
                            "What do maltose and lactose contain? What's different?"
                        ],
                        markScheme: [
                            "(i) More sucrose = more fructose released = more colour produced (linear relationship)",
                            "(ii) Maltose and lactose do not contain fructose - they contain glucose+glucose and glucose+galactose respectively"
                        ],
                        examinerInsight: "Know your disaccharide compositions: maltose = glucose+glucose, sucrose = glucose+fructose, lactose = glucose+galactose. This knowledge helps answer many questions!"
                    }
                ],
                strategy: {
                    title: "Carbohydrate Knowledge",
                    content: "Learn the compositions of disaccharides: maltose (Glu+Glu), sucrose (Glu+Fru), lactose (Glu+Gal). This allows you to answer questions about digestion, testing, and synthesis."
                }
            },
            {
                id: 10,
                topic: "Nutrition & Antioxidants",
                totalMarks: 6,
                parts: [
                    {
                        label: "(a)",
                        type: "mcq",
                        marks: 1,
                        question: `How many of the following statements are TRUE for proteins?
                        <ul style="margin: 1rem 0 1rem 1.5rem;">
                            <li>Proteins contain only the elements carbon, hydrogen and nitrogen</li>
                            <li>Proteins can be made of more than one polypeptide chain</li>
                            <li>Proteins contain hydrogen bonds</li>
                        </ul>`,
                        options: [
                            { letter: "A", text: "0" },
                            { letter: "B", text: "1" },
                            { letter: "C", text: "2" },
                            { letter: "D", text: "3" }
                        ],
                        correct: "C",
                        explanation: "Statement 1 is FALSE - proteins also contain oxygen (C, H, O, N, and sometimes S). Statement 2 is TRUE - this is quaternary structure. Statement 3 is TRUE - hydrogen bonds in secondary and tertiary structure. So 2 statements are true."
                    },
                    {
                        label: "(b)",
                        type: "mcq",
                        marks: 1,
                        question: "Which row of the table is correct for an unsaturated fatty acid?",
                        tableHtml: `
                            <table class="data-table">
                                <thead>
                                    <tr><th></th><th>Double bonds</th><th>State at room temperature</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>A</strong></td><td>Contains C=C</td><td>Liquid</td></tr>
                                    <tr><td><strong>B</strong></td><td>Contains C=C</td><td>Solid</td></tr>
                                    <tr><td><strong>C</strong></td><td>No C=C</td><td>Liquid</td></tr>
                                    <tr><td><strong>D</strong></td><td>No C=C</td><td>Solid</td></tr>
                                </tbody>
                            </table>
                        `,
                        options: [
                            { letter: "A", text: "Contains C=C double bonds, liquid at room temperature" },
                            { letter: "B", text: "Contains C=C double bonds, solid at room temperature" },
                            { letter: "C", text: "No C=C double bonds, liquid at room temperature" },
                            { letter: "D", text: "No C=C double bonds, solid at room temperature" }
                        ],
                        correct: "A",
                        explanation: "Unsaturated = has C=C double bonds. These create kinks that prevent close packing, so they're liquid at room temperature (oils). Saturated fats pack closely and are solid (fats/butter)."
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 4,
                        question: "Explain why dietary antioxidants are important.",
                        hints: [
                            "What do antioxidants do to free radicals?",
                            "What damage can free radicals cause to blood vessels?",
                            "How does this link to cardiovascular disease (CVD)?"
                        ],
                        markScheme: [
                            "Antioxidants neutralise/reduce free radicals",
                            "They donate electrons to free radicals / prevent oxidative damage",
                            "Free radicals damage blood vessel endothelium/linings",
                            "This reduces atheroma/plaque formation",
                            "Reduces risk of CVD/heart attacks/strokes"
                        ],
                        examinerInsight: "Good responses traced the full pathway: antioxidants ‚Üí neutralise free radicals ‚Üí prevent vessel damage ‚Üí reduce atheroma ‚Üí reduce CVD risk. Many stopped after just mentioning free radicals.",
                        examinerTip: "For 'explain why X is important' questions, trace through the full sequence of consequences. Show the examiner you understand the complete picture."
                    }
                ],
                strategy: {
                    title: "Applying Knowledge to Health",
                    content: "Questions often link biochemistry to health outcomes. Trace cause ‚Üí effect chains completely. For antioxidants: free radicals ‚Üí damage ‚Üí atheroma ‚Üí CVD."
                }
            },
            {
                id: 11,
                topic: "Blood Clotting & Enzymes",
                totalMarks: 7,
                parts: [
                    {
                        label: "(a)",
                        type: "written",
                        marks: 2,
                        question: "Stents can damage endothelial cells lining arteries and trigger blood clot formation. Explain how damage to endothelial cells results in the formation of <strong>thrombin</strong>.",
                        hints: [
                            "What's released when cells are damaged?",
                            "What does this activate in the clotting cascade?"
                        ],
                        markScheme: [
                            "Damaged cells/platelets release thromboplastin (clotting factors)",
                            "Thromboplastin converts prothrombin to thrombin"
                        ],
                        examinerInsight: "Many forgot to mention that thromboplastin comes FROM platelets/damaged cells. Just saying 'thromboplastin activates prothrombin' missed the first mark."
                    },
                    {
                        label: "(b)",
                        type: "mcq",
                        marks: 1,
                        question: "A tick produces variegin, a peptide of 32 amino acids that binds to thrombin's active site and prevents blood clotting. Which is the <strong>minimum</strong> number of DNA bases needed in the gene that codes for this peptide?",
                        options: [
                            { letter: "A", text: "32" },
                            { letter: "B", text: "33" },
                            { letter: "C", text: "96" },
                            { letter: "D", text: "99" }
                        ],
                        correct: "C",
                        explanation: "Each amino acid requires a codon of 3 bases. 32 amino acids √ó 3 bases = 96 bases minimum. (The stop codon would add more, but we're asked for minimum.)"
                    },
                    {
                        label: "(c)",
                        type: "written",
                        marks: 2,
                        question: "Variegin binds to the active site of thrombin. Explain how variegin prevents blood clotting.",
                        hints: [
                            "If the active site is blocked, what can't happen?",
                            "What's the consequence for fibrin and clot formation?"
                        ],
                        markScheme: [
                            "Fibrinogen (substrate) cannot bind to thrombin's active site",
                            "Fibrinogen cannot be converted to fibrin",
                            "Fibrin mesh cannot form / no clot structure"
                        ],
                        examinerInsight: "Good responses explained what WON'T happen (fibrin won't form, mesh won't form). If you just say 'blood clot won't form' you're repeating the question - explain WHY.",
                        examinerTip: "Don't just repeat the question stem as your answer - you won't get marks for telling us what we told you."
                    },
                    {
                        label: "(d)",
                        type: "written",
                        marks: 2,
                        question: "Thrombin slowly splits variegin into two molecules. Explain how thrombin splits variegin.",
                        hints: [
                            "Variegin is a peptide. What type of bonds are in peptides?",
                            "Thrombin is an enzyme that can break proteins. What type of reaction is this?"
                        ],
                        markScheme: [
                            "Thrombin acts as an enzyme / catalyses the reaction",
                            "Hydrolysis reaction breaks peptide bond(s) in variegin"
                        ],
                        examinerInsight: "Think about what you're told: variegin is a peptide (so has peptide bonds), thrombin is an enzyme. Put these together - thrombin must be catalysing hydrolysis of peptide bonds.",
                        examinerTip: "Use the information given in the question. If something is described as a 'peptide', think about what bonds it contains."
                    }
                ],
                strategy: {
                    title: "Medical Application of Biochemistry",
                    content: "These questions apply enzyme concepts to medicine. The key principles (active sites, substrates, inhibitors) are the same - just in a clinical context about blood clotting."
                }
            },
            {
                id: 12,
                topic: "Water - Gap Fill",
                totalMarks: 5,
                parts: [
                    {
                        label: "Complete the passage",
                        type: "gapfill",
                        marks: 5,
                        question: `Read through the following description of water. Complete the description by writing the most appropriate word in each gap.
                        <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0; line-height: 2.5;">
                            <p>Water has an uneven charge distribution so it is described as a</p>
                            <p><strong style="background: rgba(245, 158, 11, 0.3); padding: 0.25rem 1rem; border-radius: 4px;">(1) _____________</strong> molecule.</p>
                            <p style="margin-top: 1rem;">The hydrogen ends of the molecule have a very slightly</p>
                            <p><strong style="background: rgba(245, 158, 11, 0.3); padding: 0.25rem 1rem; border-radius: 4px;">(2) _____________</strong> charge.</p>
                            <p style="margin-top: 1rem;">Water is involved in the transport of substances so it is an important</p>
                            <p><strong style="background: rgba(245, 158, 11, 0.3); padding: 0.25rem 1rem; border-radius: 4px;">(3) _____________</strong> in living organisms.</p>
                            <p style="margin-top: 1rem;">Water is needed in chemical reactions called</p>
                            <p><strong style="background: rgba(245, 158, 11, 0.3); padding: 0.25rem 1rem; border-radius: 4px;">(4) _____________</strong> reactions</p>
                            <p style="margin-top: 1rem;">that break down disaccharides such as</p>
                            <p><strong style="background: rgba(245, 158, 11, 0.3); padding: 0.25rem 1rem; border-radius: 4px;">(5) _____________</strong> into glucose and galactose.</p>
                        </div>`,
                        hints: [
                            "Think about water's molecular structure and charge distribution - what type of molecule is it?",
                            "Oxygen pulls electrons towards it - so what charge is left on the hydrogens?",
                            "What role does water play in dissolving substances?",
                            "What type of reaction uses water to break bonds?",
                            "Which disaccharide gives glucose + galactose when broken down?"
                        ],
                        markScheme: [
                            "(1) polar OR dipolar",
                            "(2) positive",
                            "(3) solvent",
                            "(4) hydrolysis",
                            "(5) lactose"
                        ],
                        examinerInsight: "Most scored 4-5 marks. Common errors: (1) 'polar' was accepted but 'dipolar' is more precise; (4) confusion between condensation (joins, releases water) and hydrolysis (breaks, uses water); (5) some wrote maltose (glu+glu) or sucrose (glu+fru) instead of lactose (glu+gal).",
                        examinerTip: "Read the whole passage before filling gaps - context helps. The last gap specifically says 'glucose AND galactose' - only lactose fits this."
                    }
                ],
                strategy: {
                    title: "Gap Fill Strategy",
                    content: "Read the entire passage first to understand context. Look for clues in surrounding text. For disaccharides, know: maltose = Glu+Glu, sucrose = Glu+Fru, lactose = Glu+Gal."
                }
            }
        ];

        // State
        let currentQuestionIndex = 0;
        let completedQuestions = new Set();
        let questionScores = {};
        let hintsUsed = {};

        function getScaffoldLevel() {
            const progress = completedQuestions.size / questions.length;
            if (progress < 0.25) return { level: "High Support", fill: 100, desc: "Full hints and strategy guidance" };
            if (progress < 0.5) return { level: "Medium Support", fill: 66, desc: "Hints available, less guidance" };
            if (progress < 0.75) return { level: "Light Support", fill: 33, desc: "Minimal hints, building independence" };
            return { level: "Independent", fill: 10, desc: "You've got this! Minimal scaffolding" };
        }

        function updateProgress() {
            const completed = completedQuestions.size;
            const total = questions.length;
            const percentage = (completed / total) * 100;
            
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('currentQ').textContent = currentQuestionIndex + 1;
            document.getElementById('remainingCount').textContent = Math.max(0, total - completed - 1);
            document.getElementById('progressFill').style.width = percentage + '%';

            const scaffold = getScaffoldLevel();
            document.getElementById('scaffoldLevel').textContent = scaffold.level;
            document.getElementById('scaffoldFill').style.width = scaffold.fill + '%';
            document.getElementById('scaffoldDesc').textContent = scaffold.desc;

            const nav = document.getElementById('questionNav');
            nav.innerHTML = questions.map((q, i) => {
                let className = 'q-dot';
                if (completedQuestions.has(i)) className += ' completed';
                else if (i === currentQuestionIndex) className += ' current';
                return `<div class="${className}" onclick="goToQuestion(${i})">${i + 1}</div>`;
            }).join('');
        }

        function startSession() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('scaffoldIndicator').style.display = 'block';
            renderQuestion();
            updateProgress();
        }

        function renderQuestion() {
            const q = questions[currentQuestionIndex];
            const scaffold = getScaffoldLevel();
            const showFullStrategy = scaffold.fill >= 66;
            const showHints = scaffold.fill >= 33;
            
            let html = `
                <div class="question-card">
                    <div class="question-meta">
                        <span class="question-number">Question ${currentQuestionIndex + 1}</span>
                        <span class="question-marks">${q.totalMarks} marks</span>
                    </div>
                    <span class="question-topic">${q.topic}</span>
            `;

            if (showFullStrategy && q.strategy) {
                html += `
                    <div class="strategy-panel">
                        <div class="strategy-header">
                            <div class="strategy-icon">üéØ</div>
                            <span class="strategy-title">${q.strategy.title}</span>
                        </div>
                        <div class="strategy-content">${q.strategy.content}</div>
                    </div>
                `;
            }

            q.parts.forEach((part, partIndex) => {
                html += `<div class="sub-question" id="part-${partIndex}">`;
                html += `<div class="sub-question-label">${part.label} [${part.marks} mark${part.marks > 1 ? 's' : ''}]</div>`;
                html += `<div class="question-text">${part.question}</div>`;

                // Show table if present
                if (part.tableHtml) {
                    html += part.tableHtml;
                }

                // Show diagram area if present
                if (part.diagramHtml) {
                    html += part.diagramHtml;
                }

                if (part.type === 'mcq') {
                    html += `<div class="mcq-options" id="mcq-${partIndex}">`;
                    part.options.forEach(opt => {
                        html += `
                            <div class="mcq-option" onclick="selectOption(${partIndex}, '${opt.letter}')">
                                <span class="option-letter">${opt.letter}</span>
                                <span>${opt.text}</span>
                            </div>
                        `;
                    });
                    html += `</div>`;
                } else if (part.type === 'written' || part.type === 'extended' || part.type === 'table-completion') {
                    html += `
                        <div class="answer-section">
                            <label class="answer-label">Your answer:</label>
                            <textarea class="answer-textarea" id="answer-${partIndex}" placeholder="Write your answer here..."></textarea>
                        </div>
                    `;
                } else if (part.type === 'calculation') {
                    html += `
                        <div class="answer-section">
                            <label class="answer-label">Show your working and answer:</label>
                            <textarea class="answer-textarea" id="answer-${partIndex}" placeholder="Show your working here..."></textarea>
                        </div>
                    `;
                } else if (part.type === 'diagram') {
                    html += `
                        <div class="answer-section">
                            <label class="answer-label">Draw your answer on paper, then describe key features:</label>
                            <textarea class="answer-textarea" id="answer-${partIndex}" placeholder="Describe what you drew..."></textarea>
                        </div>
                    `;
                } else if (part.type === 'gapfill') {
                    html += `
                        <div class="answer-section">
                            <label class="answer-label">Write your answers for each gap:</label>
                            <textarea class="answer-textarea" id="answer-${partIndex}" placeholder="(1) ...\n(2) ...\n(3) ...\n(4) ...\n(5) ..."></textarea>
                        </div>
                    `;
                }

                // Hints
                if (showHints && part.hints && part.hints.length > 0) {
                    const hintKey = `${currentQuestionIndex}-${partIndex}`;
                    const usedHints = hintsUsed[hintKey] || 0;
                    
                    html += `<div class="hint-section">`;
                    html += `<button class="hint-btn" onclick="showHint(${partIndex})" ${usedHints >= part.hints.length ? 'disabled' : ''}>
                        üí° ${usedHints > 0 ? 'Next Hint' : 'Get Hint'} (${usedHints}/${part.hints.length})
                    </button>`;
                    
                    part.hints.forEach((hint, hintIdx) => {
                        html += `
                            <div class="hint-box ${hintIdx < usedHints ? 'visible' : ''}" id="hint-${partIndex}-${hintIdx}">
                                <div class="hint-level">Hint ${hintIdx + 1}</div>
                                ${hint}
                            </div>
                        `;
                    });
                    html += `</div>`;
                }

                // Mark scheme
                html += `<div class="markscheme-panel" id="markscheme-${partIndex}">`;
                html += `<div class="markscheme-header"><h3>‚úì Mark Scheme</h3></div>`;
                html += `<div class="markscheme-content">`;
                
                if (part.markScheme) {
                    part.markScheme.forEach((point, idx) => {
                        html += `
                            <div class="mark-point">
                                <span class="mark-bullet">${idx + 1}</span>
                                <span class="mark-text">${point}</span>
                            </div>
                        `;
                    });
                }
                if (part.correct) {
                    html += `<div class="mark-point">
                        <span class="mark-bullet">‚úì</span>
                        <span class="mark-text">Correct answer: <strong>${part.correct}</strong></span>
                    </div>`;
                }
                if (part.explanation) {
                    html += `<p style="margin-top: 1rem; color: var(--text-secondary);"><em>${part.explanation}</em></p>`;
                }
                if (part.working) {
                    html += `<p style="margin-top: 1rem; color: var(--text-secondary);"><strong>Working:</strong> ${part.working}</p>`;
                }
                if (part.answer) {
                    html += `<p style="color: var(--accent-green);"><strong>Answer:</strong> ${part.answer}</p>`;
                }
                html += `</div></div>`;

                // Examiner insight
                if (part.examinerInsight || part.examinerTip) {
                    html += `<div class="examiner-panel" id="examiner-${partIndex}">`;
                    html += `<div class="examiner-header">
                        <div class="examiner-icon">üìã</div>
                        <span class="examiner-title">Examiner's Insight</span>
                    </div>`;
                    html += `<div class="examiner-content">`;
                    
                    if (part.examinerInsight) {
                        html += `<div class="common-error"><strong>Common Issues:</strong> ${part.examinerInsight}</div>`;
                    }
                    if (part.examinerTip) {
                        html += `<div class="examiner-tip"><strong>üí° Tip:</strong> ${part.examinerTip}</div>`;
                    }
                    html += `</div></div>`;
                }

                html += `</div>`;
            });

            html += `
                <div class="action-buttons">
                    <button class="btn btn-reveal" onclick="revealAnswers()">
                        Show Mark Scheme & Insights
                    </button>
                </div>
            `;

            html += `
                <div class="self-assess" id="selfAssess" style="display: none;">
                    <div class="self-assess-title">How did you do? Rate your performance:</div>
                    <div class="score-buttons">
                        <button class="score-btn" onclick="selfScore(0)">0 - Struggled</button>
                        <button class="score-btn" onclick="selfScore(1)">1 - Partial</button>
                        <button class="score-btn" onclick="selfScore(2)">2 - Good</button>
                        <button class="score-btn" onclick="selfScore(3)">3 - Excellent</button>
                    </div>
                </div>
            `;

            html += `
                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevQuestion()" ${currentQuestionIndex === 0 ? 'disabled' : ''}>
                        ‚Üê Previous
                    </button>
                    <button class="btn btn-primary" onclick="nextQuestion()">
                        ${currentQuestionIndex === questions.length - 1 ? 'Finish Session' : 'Next Question ‚Üí'}
                    </button>
                </div>
            `;

            html += `</div>`;

            document.getElementById('questionContainer').innerHTML = html;
        }

        function selectOption(partIndex, letter) {
            const container = document.getElementById(`mcq-${partIndex}`);
            const options = container.querySelectorAll('.mcq-option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            const selected = [...options].find(opt => opt.querySelector('.option-letter').textContent === letter);
            if (selected) selected.classList.add('selected');
        }

        function showHint(partIndex) {
            const hintKey = `${currentQuestionIndex}-${partIndex}`;
            hintsUsed[hintKey] = (hintsUsed[hintKey] || 0) + 1;
            
            const hintBox = document.getElementById(`hint-${partIndex}-${hintsUsed[hintKey] - 1}`);
            if (hintBox) hintBox.classList.add('visible');
            
            const part = questions[currentQuestionIndex].parts[partIndex];
            const btn = document.querySelector(`#part-${partIndex} .hint-btn`);
            if (btn) {
                btn.innerHTML = `üí° ${hintsUsed[hintKey] < part.hints.length ? 'Next Hint' : 'No more hints'} (${hintsUsed[hintKey]}/${part.hints.length})`;
                if (hintsUsed[hintKey] >= part.hints.length) btn.disabled = true;
            }
        }

        function revealAnswers() {
            const q = questions[currentQuestionIndex];
            
            q.parts.forEach((part, idx) => {
                const ms = document.getElementById(`markscheme-${idx}`);
                if (ms) ms.classList.add('visible');
                
                const ex = document.getElementById(`examiner-${idx}`);
                if (ex) ex.classList.add('visible');
                
                if (part.type === 'mcq' && part.correct) {
                    const container = document.getElementById(`mcq-${idx}`);
                    if (container) {
                        const options = container.querySelectorAll('.mcq-option');
                        options.forEach(opt => {
                            const letter = opt.querySelector('.option-letter').textContent;
                            if (letter === part.correct) {
                                opt.classList.add('correct');
                            } else if (opt.classList.contains('selected')) {
                                opt.classList.add('incorrect');
                            }
                        });
                    }
                }
            });
            
            document.getElementById('selfAssess').style.display = 'block';
        }

        function selfScore(score) {
            questionScores[currentQuestionIndex] = score;
            completedQuestions.add(currentQuestionIndex);
            
            const btns = document.querySelectorAll('.score-btn');
            btns.forEach((btn, idx) => {
                btn.classList.toggle('selected', idx === score);
            });
            
            updateProgress();
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
                updateProgress();
                window.scrollTo(0, 0);
            } else {
                showCompletion();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        function goToQuestion(index) {
            currentQuestionIndex = index;
            renderQuestion();
            updateProgress();
            window.scrollTo(0, 0);
        }

        function showCompletion() {
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('completionScreen').style.display = 'block';
            document.getElementById('scaffoldIndicator').style.display = 'none';
            
            document.getElementById('finalCompleted').textContent = completedQuestions.size;
            
            const totalMarks = questions.reduce((sum, q) => sum + q.totalMarks, 0);
            document.getElementById('finalMarks').textContent = totalMarks;
        }

        function restartSession() {
            currentQuestionIndex = 0;
            completedQuestions.clear();
            questionScores = {};
            hintsUsed = {};
            
            document.getElementById('completionScreen').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('scaffoldIndicator').style.display = 'block';
            
            renderQuestion();
            updateProgress();
            window.scrollTo(0, 0);
        }

        function reviewAll() {
            currentQuestionIndex = 0;
            document.getElementById('completionScreen').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('scaffoldIndicator').style.display = 'block';
            
            renderQuestion();
            updateProgress();
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
